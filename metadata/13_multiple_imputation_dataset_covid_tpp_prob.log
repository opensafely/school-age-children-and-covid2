2021-07-20T16:04:46.868001900Z 
2021-07-20T16:04:46.868072600Z   ___  ____  ____  ____  ____ (R)
2021-07-20T16:04:46.868081300Z  /__    /   ____/   /   ____/
2021-07-20T16:04:46.868085600Z ___/   /   /___/   /   /___/   16.1   Copyright 1985-2019 StataCorp LLC
2021-07-20T16:04:46.868089500Z   Statistics/Data Analysis            StataCorp
2021-07-20T16:04:46.868093100Z                                       4905 Lakeway Drive
2021-07-20T16:04:46.868096300Z                                       College Station, Texas 77845 USA
2021-07-20T16:04:46.868098500Z                                       800-STATA-PC        http://www.stata.com
2021-07-20T16:04:46.868100800Z                                       979-696-4600        stata@stata.com
2021-07-20T16:04:46.868103000Z                                       979-696-4601 (fax)
2021-07-20T16:04:46.868105300Z 
2021-07-20T16:04:46.868107300Z 3-user Stata network license expires 11 May 2022:
2021-07-20T16:04:46.868109400Z        Serial number:  501709312237
2021-07-20T16:04:46.868111400Z          Licensed to:  The Bennett Institute
2021-07-20T16:04:46.868113400Z                        Oxford University
2021-07-20T16:04:46.868892500Z 
2021-07-20T16:04:46.868907500Z Notes:
2021-07-20T16:04:46.868912800Z       1.  Unicode is supported; see help unicode_advice.
2021-07-20T16:04:46.868916900Z 
2021-07-20T16:04:46.868920400Z . do "analysis/13_multiple_imputation_dataset.wrapper.do" covid_tpp_prob MAIN 
2021-07-20T16:04:46.868926400Z 
2021-07-20T16:04:46.868929900Z . . do "analysis/13_multiple_imputation_dataset.do" covid_tpp_prob MAIN
2021-07-20T16:04:46.868933600Z 
2021-07-20T16:04:46.868937000Z . *************************************************************************
2021-07-20T16:04:46.868940400Z . 
2021-07-20T16:04:46.868942400Z . *Exposure children and COVID risk
2021-07-20T16:04:46.868944600Z .   
2021-07-20T16:04:46.868947800Z . *DO file name:  13_multiple_imputation_dataset
2021-07-20T16:04:46.868951500Z . 
2021-07-20T16:04:46.868954800Z . *Purpose: Impute ethnicity
2021-07-20T16:04:46.868958300Z . *
2021-07-20T16:04:46.868961800Z . *Requires: final analysis dataset (analysis_dataset.dta)
2021-07-20T16:04:46.868965400Z . *
2021-07-20T16:04:46.868968800Z . *Coding: HFORBES, based on Krishnan Bhaskaran
2021-07-20T16:04:46.868972400Z . *
2021-07-20T16:04:46.868975700Z . *Date drafted: 18th August 2020
2021-07-20T16:04:46.868979300Z . *************************************************************************
2021-07-20T16:04:46.868983000Z . 
2021-07-20T16:04:46.868986400Z . 
2021-07-20T16:04:46.868989700Z . * Set globals that will print in programs and direct output
2021-07-20T16:04:46.869003500Z . global outdir     "output" 
2021-07-20T16:04:46.869008200Z 
2021-07-20T16:04:46.869010400Z . global logdir     "log"
2021-07-20T16:04:46.869016000Z 
2021-07-20T16:04:46.869018500Z . global tempdir    "tempdata"
2021-07-20T16:04:46.869020800Z 
2021-07-20T16:04:46.869022900Z . 
2021-07-20T16:04:46.869025000Z . 
2021-07-20T16:04:46.869026900Z . local outcome `1' 
2021-07-20T16:04:46.869028900Z 
2021-07-20T16:04:46.869030800Z . local dataset `2'
2021-07-20T16:04:46.869032900Z 
2021-07-20T16:04:46.869036200Z . 
2021-07-20T16:04:46.869039600Z . * Open a log file
2021-07-20T16:04:46.869043000Z . capture log close
2021-07-20T16:04:46.869046300Z 
2021-07-20T16:04:46.869049600Z . log using "$logdir/13_multiple_imputation_dataset_`outcome'`dataset'", text r
2021-07-20T16:04:46.869053100Z > eplace
2021-07-20T16:04:46.869203500Z (note: file /workspace/log/13_multiple_imputation_dataset_covid_tpp_probMAIN.lo
2021-07-20T16:04:46.869214000Z > g not found)
2021-07-20T16:04:46.869218700Z -------------------------------------------------------------------------------
2021-07-20T16:04:46.869222600Z       name:  <unnamed>
2021-07-20T16:04:46.869226300Z        log:  /workspace/log/13_multiple_imputation_dataset_covid_tpp_probMAIN.l
2021-07-20T16:04:46.869230100Z > og
2021-07-20T16:04:46.869233700Z   log type:  text
2021-07-20T16:04:46.869237000Z  opened on:  20 Jul 2021, 16:04:46
2021-07-20T16:04:46.869240400Z 
2021-07-20T16:04:46.869244200Z . 
2021-07-20T16:04:46.869296900Z . 
2021-07-20T16:04:46.869321500Z . use  "$tempdir/analysis_dataset_with_missing_ethnicity`dataset'", clear
2021-07-20T16:04:46.874267400Z 
2021-07-20T16:04:46.874315200Z . keep if age<=65
2021-07-20T16:04:46.879525000Z (5,024 observations deleted)
2021-07-20T16:04:46.879542600Z 
2021-07-20T16:04:46.879546000Z . * Create restricted cubic splines for age
2021-07-20T16:04:46.879549400Z . mkspline age = age, cubic nknots(4)
2021-07-20T16:04:46.926060600Z 
2021-07-20T16:04:46.926089200Z . save "$tempdir/analysis_dataset_with_missing_ethnicity_ageband_0`dataset'", r
2021-07-20T16:04:46.926107300Z > eplace
2021-07-20T16:04:46.931058000Z (note: file tempdata/analysis_dataset_with_missing_ethnicity_ageband_0MAIN.dta 
2021-07-20T16:04:46.931085500Z > not found)
2021-07-20T16:04:46.931089300Z file tempdata/analysis_dataset_with_missing_ethnicity_ageband_0MAIN.dta saved
2021-07-20T16:04:46.931091700Z 
2021-07-20T16:04:46.931093700Z . 
2021-07-20T16:04:46.931105300Z . 
2021-07-20T16:04:46.931107700Z . use  "$tempdir/analysis_dataset_with_missing_ethnicity`dataset'", clear
2021-07-20T16:04:46.933998200Z 
2021-07-20T16:04:46.934021000Z . keep if age>65
2021-07-20T16:04:46.939331200Z (17,952 observations deleted)
2021-07-20T16:04:46.939355700Z 
2021-07-20T16:04:46.939360400Z . * Create restricted cubic splines for age
2021-07-20T16:04:46.939365100Z . mkspline age = age, cubic nknots(4)
2021-07-20T16:04:46.961987500Z 
2021-07-20T16:04:46.962008100Z . save "$tempdir/analysis_dataset_with_missing_ethnicity_ageband_1`dataset'", r
2021-07-20T16:04:46.962011800Z > eplace
2021-07-20T16:04:46.963470200Z (note: file tempdata/analysis_dataset_with_missing_ethnicity_ageband_1MAIN.dta 
2021-07-20T16:04:46.963487000Z > not found)
2021-07-20T16:04:46.963493200Z file tempdata/analysis_dataset_with_missing_ethnicity_ageband_1MAIN.dta saved
2021-07-20T16:04:46.963497700Z 
2021-07-20T16:04:46.963533500Z . 
2021-07-20T16:04:46.963542600Z . *****************************************************************************
2021-07-20T16:04:46.963547900Z > **
2021-07-20T16:04:46.963551900Z . forvalues x=0/1 {
2021-07-20T16:04:46.963555600Z   2. 
2021-07-20T16:04:46.963559400Z . use "$tempdir/analysis_dataset_with_missing_ethnicity_ageband_`x'`dataset'", 
2021-07-20T16:04:46.963563600Z > clear
2021-07-20T16:04:46.963567500Z   3. replace ethnicity=. if ethnicity==.u 
2021-07-20T16:04:46.963571500Z   4. count
2021-07-20T16:04:46.963575300Z   5. * Save a version set on NON ONS covid death outcome
2021-07-20T16:04:46.963579900Z . stset stime_`outcome', fail(`outcome')                          ///
2021-07-20T16:04:46.963583800Z >         id(patient_id) enter(enter_date) origin(enter_date)
2021-07-20T16:04:46.963587800Z   6.         
2021-07-20T16:04:46.963591400Z . drop if _st==0  
2021-07-20T16:04:46.963595100Z   7. mi set wide
2021-07-20T16:04:46.963599100Z   8. mi register imputed ethnicity
2021-07-20T16:04:46.963602800Z   9. 
2021-07-20T16:04:46.963607600Z . *Gen NA Cum Haz
2021-07-20T16:04:46.963611500Z . sts generate cumh = na
2021-07-20T16:04:46.963615400Z  10. egen cumhgp = cut(cumh), group(5)
2021-07-20T16:04:46.963619400Z  11. replace cumhgp = cumhgp + 1
2021-07-20T16:04:46.963623300Z  12. 
2021-07-20T16:04:46.963627200Z . *HIV code: mi impute mlogit ethnicity i.hiv i.stp $adjustmentlist i.cumhgp _d
2021-07-20T16:04:46.963631600Z > , add(10) rseed(3040985)
2021-07-20T16:04:46.963635800Z . 
2021-07-20T16:04:46.963644800Z . *What's the cumulative hazard for?
2021-07-20T16:04:46.963656600Z . *Do we need to include household id in some way?
2021-07-20T16:04:46.963659300Z . recode diabcat .=0
2021-07-20T16:04:46.963661600Z  13. mi impute mlogit ethnicity ///
2021-07-20T16:04:46.963663900Z >                         i.kids_cat4 age1 age2 age3              ///
2021-07-20T16:04:46.963666300Z >                         i.male                                               
2021-07-20T16:04:46.963668900Z >    ///
2021-07-20T16:04:46.963671300Z >                         i.obese4cat                                     ///
2021-07-20T16:04:46.963673800Z >                         i.smoke_nomiss                                  ///
2021-07-20T16:04:46.963676300Z >                         i.imd                                                
2021-07-20T16:04:46.963679400Z >    ///
2021-07-20T16:04:46.963682900Z >                         i.htdiag_or_highbp                              ///
2021-07-20T16:04:46.963686800Z >                         i.chronic_respiratory_disease   ///
2021-07-20T16:04:46.963690900Z >                         i.asthma                                             
2021-07-20T16:04:46.963695500Z >    ///
2021-07-20T16:04:46.963699900Z >                         i.chronic_cardiac_disease               ///
2021-07-20T16:04:46.963702400Z >                         i.diabcat                                            
2021-07-20T16:04:46.963705000Z >    ///
2021-07-20T16:04:46.963707200Z >                         i.cancer_exhaem_cat                             ///
2021-07-20T16:04:46.963709700Z >                         i.chronic_liver_disease                 ///
2021-07-20T16:04:46.963712100Z >                         i.stroke_dementia                               ///
2021-07-20T16:04:46.963714600Z >                         i.other_transplant                                   
2021-07-20T16:04:46.963717200Z >    ///
2021-07-20T16:04:46.963719500Z >                         i.asplenia                                           
2021-07-20T16:04:46.963722000Z >    ///
2021-07-20T16:04:46.963724400Z >                         i.stp                                                
2021-07-20T16:04:46.963726700Z >    ///
2021-07-20T16:04:46.963728900Z >                         i.cumhgp                                             
2021-07-20T16:04:46.963731200Z >    ///
2021-07-20T16:04:46.963733400Z >                         i.cancer_haem_cat                               ///
2021-07-20T16:04:46.963736000Z >                         i.other_neuro                                   ///
2021-07-20T16:04:46.963738500Z >                         i.reduced_kidney_function_cat   ///
2021-07-20T16:04:46.963741000Z >                         i.esrd                                               
2021-07-20T16:04:46.963746900Z >    ///
2021-07-20T16:04:46.963749200Z >                         i.tot_adults_hh                                 ///
2021-07-20T16:04:46.963751500Z >                         i.ra_sle_psoriasis                      ///
2021-07-20T16:04:46.963754400Z >                         i.other_immuno                                  ///
2021-07-20T16:04:46.963756800Z >                         , add(10) rseed(894726318) augment
2021-07-20T16:04:46.963761100Z  14. 
2021-07-20T16:04:46.963763600Z . 
2021-07-20T16:04:46.963766000Z . save "$tempdir/cr_imputed_analysis_dataset_STSET_`outcome'_ageband_`x'`datase
2021-07-20T16:04:46.963768600Z > t'.dta", replace
2021-07-20T16:04:46.963770900Z  15.         
2021-07-20T16:04:46.963773100Z . }       
2021-07-20T16:04:46.967863700Z (1,746 real changes made, 1,746 to missing)
2021-07-20T16:04:46.967898900Z   17,952
2021-07-20T16:04:47.242867700Z 
2021-07-20T16:04:47.242891100Z                 id:  patient_id
2021-07-20T16:04:47.242896000Z      failure event:  covid_tpp_prob != 0 & covid_tpp_prob < .
2021-07-20T16:04:47.242900600Z obs. time interval:  (stime_covid_tpp_prob[_n-1], stime_covid_tpp_prob]
2021-07-20T16:04:47.242904500Z  enter on or after:  time enter_date
2021-07-20T16:04:47.242908100Z  exit on or before:  failure
2021-07-20T16:04:47.242911600Z     t for analysis:  (time-origin)
2021-07-20T16:04:47.242915300Z             origin:  time enter_date
2021-07-20T16:04:47.242918900Z 
2021-07-20T16:04:47.242922200Z ------------------------------------------------------------------------------
2021-07-20T16:04:47.242926000Z      17,952  total observations
2021-07-20T16:04:47.243676200Z           0  exclusions
2021-07-20T16:04:47.243691500Z ------------------------------------------------------------------------------
2021-07-20T16:04:47.243696900Z      17,952  observations remaining, representing
2021-07-20T16:04:47.275243900Z      17,952  subjects
2021-07-20T16:04:47.307971700Z       6,714  failures in single-failure-per-subject data
2021-07-20T16:04:47.375061100Z   2,651,343  total analysis time at risk and under observation
2021-07-20T16:04:47.375080300Z                                                 at risk from t =         0
2021-07-20T16:04:47.375990100Z                                      earliest observed entry t =         0
2021-07-20T16:04:47.377699700Z                                           last observed exit t =       212
2021-07-20T16:04:47.380946600Z (0 observations deleted)
2021-07-20T16:04:47.547364900Z (17,952 real changes made)
2021-07-20T16:04:47.555781200Z (diabcat: 0 changes made)
2021-07-20T16:04:55.225959400Z 
2021-07-20T16:04:55.226006200Z Univariate imputation                       Imputations =       10
2021-07-20T16:04:55.226011100Z Multinomial logistic regression                   added =       10
2021-07-20T16:04:55.226013600Z Imputed: m=1 through m=10                       updated =        0
2021-07-20T16:04:55.226016000Z 
2021-07-20T16:04:55.226018300Z ------------------------------------------------------------------
2021-07-20T16:04:55.226020800Z                    |               Observations per m             
2021-07-20T16:04:55.226023100Z                    |----------------------------------------------
2021-07-20T16:04:55.226025400Z           Variable |   Complete   Incomplete   Imputed |     Total
2021-07-20T16:04:55.232936800Z -------------------+-----------------------------------+----------
2021-07-20T16:04:55.232967400Z          ethnicity |      16206         1746      1746 |     17952
2021-07-20T16:04:55.232974900Z ------------------------------------------------------------------
2021-07-20T16:04:55.232980000Z (complete + incomplete = total; imputed is the minimum across m
2021-07-20T16:04:55.232984400Z  of the number of filled-in observations.)
2021-07-20T16:04:55.232988500Z 
2021-07-20T16:04:55.232992700Z Note: Perfect prediction was not detected.
2021-07-20T16:04:55.409034900Z (note: file tempdata/cr_imputed_analysis_dataset_STSET_covid_tpp_prob_ageband_0
2021-07-20T16:04:55.409057400Z > MAIN.dta not found)
2021-07-20T16:04:55.409064200Z file tempdata/cr_imputed_analysis_dataset_STSET_covid_tpp_prob_ageband_0MAIN.dt
2021-07-20T16:04:55.409069400Z > a saved
2021-07-20T16:04:55.409074200Z (530 real changes made, 530 to missing)
2021-07-20T16:04:55.409078800Z   5,024
2021-07-20T16:04:55.409083300Z 
2021-07-20T16:04:55.409087600Z                 id:  patient_id
2021-07-20T16:04:55.409092300Z      failure event:  covid_tpp_prob != 0 & covid_tpp_prob < .
2021-07-20T16:04:55.409097500Z obs. time interval:  (stime_covid_tpp_prob[_n-1], stime_covid_tpp_prob]
2021-07-20T16:04:55.409101300Z  enter on or after:  time enter_date
2021-07-20T16:04:55.409175500Z  exit on or before:  failure
2021-07-20T16:04:55.409198700Z     t for analysis:  (time-origin)
2021-07-20T16:04:55.409204900Z             origin:  time enter_date
2021-07-20T16:04:55.409289200Z 
2021-07-20T16:04:55.409301900Z ------------------------------------------------------------------------------
2021-07-20T16:04:55.416482200Z       5,024  total observations
2021-07-20T16:04:55.416503000Z           0  exclusions
2021-07-20T16:04:55.416507100Z ------------------------------------------------------------------------------
2021-07-20T16:04:55.416510200Z       5,024  observations remaining, representing
2021-07-20T16:04:55.420304300Z       5,024  subjects
2021-07-20T16:04:55.433069600Z       1,929  failures in single-failure-per-subject data
2021-07-20T16:04:55.456494900Z     732,079  total analysis time at risk and under observation
2021-07-20T16:04:55.456521500Z                                                 at risk from t =         0
2021-07-20T16:04:55.457030800Z                                      earliest observed entry t =         0
2021-07-20T16:04:55.457429300Z                                           last observed exit t =       212
2021-07-20T16:04:55.460531600Z (0 observations deleted)
2021-07-20T16:04:55.540966300Z (5,024 real changes made)
2021-07-20T16:04:55.540989500Z (diabcat: 0 changes made)
2021-07-20T16:04:59.361444800Z 
2021-07-20T16:04:59.361495800Z Univariate imputation                       Imputations =       10
2021-07-20T16:04:59.361548400Z Augmented multinomial logit regression            added =       10
2021-07-20T16:04:59.361556000Z Imputed: m=1 through m=10                       updated =        0
2021-07-20T16:04:59.361560800Z 
2021-07-20T16:04:59.361565200Z ------------------------------------------------------------------
2021-07-20T16:04:59.361569900Z                    |               Observations per m             
2021-07-20T16:04:59.361574500Z                    |----------------------------------------------
2021-07-20T16:04:59.361579100Z           Variable |   Complete   Incomplete   Imputed |     Total
2021-07-20T16:04:59.361584700Z -------------------+-----------------------------------+----------
2021-07-20T16:04:59.361589400Z          ethnicity |       4494          530       530 |      5024
2021-07-20T16:04:59.361594200Z ------------------------------------------------------------------
2021-07-20T16:04:59.361598600Z (complete + incomplete = total; imputed is the minimum across m
2021-07-20T16:04:59.361603000Z  of the number of filled-in observations.)
2021-07-20T16:04:59.397304700Z (note: file tempdata/cr_imputed_analysis_dataset_STSET_covid_tpp_prob_ageband_1
2021-07-20T16:04:59.397326700Z > MAIN.dta not found)
2021-07-20T16:04:59.397333000Z file tempdata/cr_imputed_analysis_dataset_STSET_covid_tpp_prob_ageband_1MAIN.dt
2021-07-20T16:04:59.397338100Z > a saved
2021-07-20T16:04:59.397342800Z 
2021-07-20T16:04:59.397346900Z . 
2021-07-20T16:04:59.397351100Z . 
2021-07-20T16:04:59.397355300Z . log close
2021-07-20T16:04:59.397535900Z       name:  <unnamed>
2021-07-20T16:04:59.397552400Z        log:  /workspace/log/13_multiple_imputation_dataset_covid_tpp_probMAIN.l
2021-07-20T16:04:59.397570800Z > og
2021-07-20T16:04:59.397591500Z   log type:  text
2021-07-20T16:04:59.397669100Z  closed on:  20 Jul 2021, 16:04:59
2021-07-20T16:04:59.397675400Z -------------------------------------------------------------------------------
2021-07-20T16:04:59.397689600Z 
2021-07-20T16:04:59.397694100Z . 
2021-07-20T16:04:59.397697600Z . 
2021-07-20T16:04:59.397701500Z . 
2021-07-20T16:04:59.397705400Z end of do-file
2021-07-20T16:04:59.397709300Z 
2021-07-20T16:04:59.397739700Z . . file open output using "/tmp/tmp.cpWz260nZw", write text replace
2021-07-20T16:04:59.397747800Z 
2021-07-20T16:04:59.397752200Z . . file write output "success" 
2021-07-20T16:04:59.397755900Z 
2021-07-20T16:04:59.397759400Z . . file close output
2021-07-20T16:04:59.397805100Z 
2021-07-20T16:04:59.397819400Z . 
2021-07-20T16:04:59.397825200Z end of do-file
2021-07-20T16:04:59.397829500Z 
2021-07-20T16:04:59.397833200Z 
2021-07-20T16:04:59.429743400Z . 

state: succeeded
commit: none
docker_image_id: sha256:11980aa720220a1b39bf523f5a8a33270214c13876c30ee364e16265766f7f60
exit_code: 0
job_id: ey2qcqjgzi4pccsl
run_by_user: qc18278
created_at: 2021-07-20T15:38:48Z
started_at: 2021-07-20T16:04:46Z
completed_at: 2021-07-20T16:05:36Z

Completed successfully

outputs:
  log/13_multiple_imputation_dataset_covid_tpp_probMAIN.log                    - moderately_sensitive
  tempdata/cr_imputed_analysis_dataset_STSET_covid_tpp_prob_ageband_0MAIN.dta  - highly_sensitive    
  tempdata/cr_imputed_analysis_dataset_STSET_covid_tpp_prob_ageband_1MAIN.dta  - highly_sensitive    